#!/bin/bash
source ~/.bashrc
shopt -s expand_aliases
oci() {
  docker run --rm -i \
    -e "OCI_CLI_SUPPRESS_FILE_PERMISSIONS_WARNING=True" \
    -v "$HOME/.oci:/oracle/.oci" oci "$@"
}

# ç¡®ä¿ $C å·²ç»å­˜åœ¨
echo "æ­£åœ¨ä¸º Compartment $C è·å–èµ„æº..."

# ä¼˜åŒ–æŸ¥è¯¢ï¼šjoin(' ', @) ä¼šæŠŠæ•°ç»„å˜æˆç©ºæ ¼åˆ†éš”çš„å­—ç¬¦ä¸²ï¼Œå®Œç¾é€‚é… for å¾ªç¯
ADS=$(oci iam availability-domain list -c $C --query "data[*].name | join(' ', @)" --raw-output)

for ad in $ADS; do
    echo -e "\nğŸ“ Availability Domain: $ad"
    echo "------------------------------------------------"
    
    # è·å–è¯¥ AD ä¸‹çš„ Fault Domains
    # åŒæ ·ä½¿ç”¨ join ç¡®ä¿è¾“å‡ºæ•´æ´
    oci iam fault-domain list -c $C --availability-domain "$ad" \
        --query "data[*].name | join(', ', @)" --raw-output
done
